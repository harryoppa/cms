(()=>{function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t={},a=function(){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}var r,n,o;return r=a,o=[{key:"loadWidget",value:function(e,r,n,o){var l=e.closest(".widget_item"),d=l.attr("id");void 0!==o&&(t[d]=o);var s=l.find("a.collapse-expand");if(!s.length||!s.hasClass("collapse")){TVHung.blockUI({target:e,iconOnly:!0,overlayColor:"none"}),void 0!==n&&null!=n||(n={});var i=l.find("select[name=predefined_range]");i.length&&(n.predefined_range=i.val()),$.ajax({type:"GET",cache:!1,url:r,data:n,success:function(r){TVHung.unblockUI(e),r.error?e.html('<div class="dashboard_widget_msg col-12"><p>'+r.message+"</p>"):(e.html(r.data),void 0!==o?o():t[d]&&t[d](),0!==e.find(".scroller").length&&TVHung.callScroll(e.find(".scroller")),$(".equal-height").equalHeights(),a.initSortable())},error:function(t){TVHung.unblockUI(e),TVHung.handleError(t)}})}}},{key:"initSortable",value:function(){if($("#list_widgets").length>0){var e=document.getElementById("list_widgets");Sortable.create(e,{group:"widgets",sort:!0,delay:0,disabled:!1,store:null,animation:150,handle:".portlet-title",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dataIdAttr:"data-id",forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,scroll:!0,scrollSensitivity:30,scrollSpeed:10,onUpdate:function(){var e=[];$.each($(".widget_item"),(function(t,a){e.push($(a).prop("id"))})),$.ajax({type:"POST",cache:!1,url:route("dashboard.update_widget_order"),data:{items:e},success:function(e){e.error?TVHung.showError(e.message):TVHung.showSuccess(e.message)},error:function(e){TVHung.handleError(e)}})}})}}}],(n=[{key:"init",value:function(){var e=$("#list_widgets");$(document).on("click",".portlet > .portlet-title .tools > a.remove",(function(e){e.preventDefault(),$("#hide-widget-confirm-bttn").data("id",$(e.currentTarget).closest(".widget_item").prop("id")),$("#hide_widget_modal").modal("show")})),e.on("click",".page_next, .page_previous",(function(e){e.preventDefault(),a.loadWidget($(e.currentTarget).closest(".portlet").find(".portlet-body"),$(e.currentTarget).prop("href"))})),e.on("change",".number_record .numb",(function(e){e.preventDefault();var t=$(".number_record .numb").val();isNaN(t)?TVHung.showError("Please input a number!"):a.loadWidget($(e.currentTarget).closest(".portlet").find(".portlet-body"),$(e.currentTarget).closest(".widget_item").attr("data-url"),{paginate:t})})),e.on("click",".btn_change_paginate",(function(e){e.preventDefault();var t=$(".number_record .numb"),r=parseInt(t.val());$(e.currentTarget).hasClass("btn_up")&&(r+=5),$(e.currentTarget).hasClass("btn_down")&&(r-5>0?r-=5:r=0),t.val(r),a.loadWidget($(e.currentTarget).closest(".portlet").find(".portlet-body"),$(e.currentTarget).closest(".widget_item").attr("data-url"),{paginate:r})})),$("#hide-widget-confirm-bttn").on("click",(function(e){e.preventDefault();var t=$(e.currentTarget).data("id");$.ajax({type:"GET",cache:!1,url:route("dashboard.hide_widget",{name:t}),success:function(a){a.error?TVHung.showError(a.message):($("#"+t).fadeOut(),TVHung.showSuccess(a.message)),$("#hide_widget_modal").modal("hide");var r=$(e.currentTarget).closest(".portlet");$(document).hasClass("page-portlet-fullscreen")&&$(document).removeClass("page-portlet-fullscreen"),r.find("[data-bs-toggle=tooltip]").tooltip("destroy"),r.remove()},error:function(e){TVHung.handleError(e)}})})),$(document).on("click",".portlet:not(.widget-load-has-callback) > .portlet-title .tools > a.reload",(function(e){e.preventDefault(),a.loadWidget($(e.currentTarget).closest(".portlet").find(".portlet-body"),$(e.currentTarget).closest(".widget_item").attr("data-url"))})),$(document).on("click",".portlet > .portlet-title .tools > .collapse, .portlet .portlet-title .tools > .expand",(function(e){e.preventDefault();var t=$(e.currentTarget),r=t.closest(".portlet"),n=$.trim(t.data("state"));"expand"===n?(r.find(".portlet-body").removeClass("collapse").addClass("expand"),a.loadWidget(r.find(".portlet-body"),t.closest(".widget_item").attr("data-url"))):r.find(".portlet-body").removeClass("expand").addClass("collapse"),$.ajax({type:"POST",cache:!1,url:route("dashboard.edit_widget_setting_item"),data:{name:t.closest(".widget_item").prop("id"),setting_name:"state",setting_value:n},success:function(){"collapse"===n?(t.data("state","expand"),r.find(".predefined-ranges").addClass("d-none"),r.find("a.reload").addClass("d-none"),r.find("a.fullscreen").addClass("d-none")):(t.data("state","collapse"),r.find(".predefined-ranges").removeClass("d-none"),r.find("a.reload").removeClass("d-none"),r.find("a.fullscreen").removeClass("d-none"))},error:function(e){TVHung.handleError(e)}})})),$(document).on("change",".portlet select[name=predefined_range]",(function(e){e.preventDefault(),$(e.currentTarget),a.loadWidget($(e.currentTarget).closest(".portlet").find(".portlet-body"),$(e.currentTarget).closest(".widget_item").attr("data-url"))}));var t=$("#manage_widget_modal");$(document).on("click",".manage-widget",(function(e){e.preventDefault(),t.modal("show")})),t.on("change",".swc_wrap input",(function(e){$(e.currentTarget).closest("section").find("i").toggleClass("widget_none_color")}))}}])&&e(r.prototype,n),o&&e(r,o),a}();$(document).ready((function(){(new a).init(),window.BDashboard=a}))})();
