(()=>{function e(r){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}var r;(r=jQuery).fn.filetree=function(t){var o={animationSpeed:"slow",console:!1};function n(e){return e=r.extend(o,e),this.each((function(){r(this).find("li").on("click",".file-opener-i",(function(e){return e.preventDefault(),r(this).hasClass("fa-plus-square")?(r(this).addClass("fa-minus-square"),r(this).removeClass("fa-plus-square")):(r(this).addClass("fa-plus-square"),r(this).removeClass("fa-minus-square")),r(this).parent().toggleClass("closed").toggleClass("open"),!1}))}))}if("object"==e(t)||!t)return n.apply(this,arguments)},function(r){r.fn.dragScroll=function(t){function o(){var e,o,n=r(this),a=r.extend({scrollVertical:!1,scrollHorizontal:!0,cursor:null},t),s=!1;n.on({mousemove:function(t){s&&function(t,n){var s=r(n);a.scrollVertical&&s.scrollTop(s.scrollTop()+(e-t.pageY)),a.scrollHorizontal&&s.scrollLeft(s.scrollLeft()+(o-t.pageX))}(t,this)},mousedown:function(r){n.css("cursor",a.cursor?a.cursor:a.scrollVertical&&a.scrollHorizontal?"move":a.scrollVertical?"row-resize":a.scrollHorizontal?"col-resize":void 0),s=!0,e=r.pageY,o=r.pageX},mouseup:function(){s=!1,n.css("cursor","auto")},mouseleave:function(){s=!1,n.css("cursor","auto")}})}if("object"==e(t)||!t)return o.apply(this,arguments)}}(jQuery),$((function(){$(".file-tree-wrapper").dragScroll();var e=$(".tree-form-container").find(".tree-loading"),r=$(".tree-categories-container").find(".tree-loading");function t(e){r.removeClass("d-none"),$(".file-tree-wrapper").filetree().removeClass("d-none").hide().slideDown("slow"),r.addClass("d-none"),e&&$(".file-tree-wrapper").find('li[data-id="'+e+'"] .category-name:first').addClass("active")}function o(e){$(".tree-form-body").html(e),TVHung.initResources(),TVHung.handleCounterUp(),TVHung.initMediaIntegrate(),window.EditorManagement&&(new EditorManagement).init()}function n(r,t){var n;(n=$.ajaxSetup().data)&&(delete n.ref_from,delete n.ref_lang),$.ajax({url:r,type:"GET",beforeSend:function(){e.removeClass("d-none"),$(".file-tree-wrapper").find("a.active").removeClass("active"),t&&t.addClass("active")},success:function(e){e.error?TVHung.showError(e.message):o(e.data)},error:function(e){TVHung.handleError(e)},complete:function(){e.addClass("d-none")}})}t(),$(document).on("click",".tree-categories-container .toggle-tree",(function(e){var r=$(e.currentTarget);r.hasClass("open-tree")?(r.text(r.data("collapse")),$(".tree-categories-container").find(".folder-root.closed").removeClass("closed").addClass("open")):(r.text(r.data("expand")),$(".tree-categories-container").find(".folder-root.open").removeClass("open").addClass("closed")),r.toggleClass("open-tree")})),$(document).on("click",".file-tree-wrapper .fetch-data",(function(e){e.preventDefault();var r=$(e.currentTarget);r.attr("href")?n(r.attr("href"),r):($(".file-tree-wrapper").find("a.active").removeClass("active"),r.addClass("active"))})),$(document).on("click",".tree-categories-create",(function(r){r.preventDefault(),function(r){var t={};a.get("ref_lang")&&(t.ref_lang=a.get("ref_lang")),$.ajax({url:r,type:"GET",data:t,beforeSend:function(){e.removeClass("d-none")},success:function(e){e.error?TVHung.showError(e.message):o(e.data)},error:function(e){TVHung.handleError(e)},complete:function(){e.addClass("d-none")}})}($(r.currentTarget).attr("href"))}));var a=new URLSearchParams(window.location.search);function s(e,r){var o=$(".file-tree-wrapper");$.ajax({url:o.data("url"),type:"GET",success:function(n){n.error?TVHung.showError(n.message):(o.html(n.data),t(e),jQuery().tooltip&&$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",boundary:"window"}),r&&r())},error:function(e){TVHung.handleError(e)}})}$(document).on("click","#list-others-language a",(function(e){e.preventDefault(),n($(e.currentTarget).prop("href"))})),$(document).on("submit",".tree-form-container form",(function(r){var t;r.preventDefault();var n=$(r.currentTarget),a=n.serializeArray(),l=null===(t=r.originalEvent)||void 0===t?void 0:t.submitter,i=!1;l&&l.name&&(i="apply"===l.value,a.push({name:l.name,value:l.value})),$.ajax({url:n.attr("action"),type:n.attr("method")||"POST",data:a,beforeSend:function(){e.removeClass("d-none")},success:function(r){if(r.error)TVHung.showError(r.message);else{TVHung.showSuccess(r.message),e.addClass("d-none");var t=i&&r.data.model?r.data.model.id:null;s(t,(function(){if(t){var n=$('.folder-root[data-id="'+t+'"] a.fetch-data');n.length?n.trigger("click"):location.reload()}else if($(".tree-categories-create").length)$(".tree-categories-create").trigger("click");else{var a;o(null===(a=r.data)||void 0===a?void 0:a.form),e.addClass("d-none")}}))}},error:function(r){TVHung.handleError(r),e.addClass("d-none")}})})),$(document).on("click",".deleteDialog",(function(e){e.preventDefault();var r=$(e.currentTarget);$(".delete-crud-entry").data("section",r.data("section")),$(".modal-confirm-delete").modal("show")})),$(".delete-crud-entry").on("click",(function(e){e.preventDefault();var r=$(e.currentTarget);r.addClass("button-loading");var t=r.data("section");$.ajax({url:t,type:"DELETE",success:function(e){e.error?TVHung.showError(e.message):(TVHung.showSuccess(e.message),s(),$(".tree-categories-create").length?$(".tree-categories-create").trigger("click"):o("")),r.closest(".modal").modal("hide"),r.removeClass("button-loading")},error:function(e){TVHung.handleError(e),r.removeClass("button-loading")}})}))}))})();
